<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homenagem Alphacampus</title>
    <!-- Fonte Arial (Padrão) -->
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background-color: #004d40; 
            background-image: url('background.jpeg'); 
            background-size: contain; /* Tenta 'contain' para garantir que a imagem inteira apareça */
            background-position: center; /* Centraliza a imagem */
            background-repeat: no-repeat; /* Evita a repetição da imagem */
            filter: none; /* Remove o filtro para garantir que a imagem apareça */
            color: #D4B851; /* Cor Amarelo-Ouro extraída da imagem */
            font-family: Arial, sans-serif; /* Mantido em Arial */ 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            overflow: hidden; 
            text-align: center; 
        }
        #name-container { 
            font-size: 4vw; 
            font-weight: 700; 
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); 
            transition: opacity 1s ease-in-out; 
            padding: 20px; 
            max-width: 90%; 
            flex: 1; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            flex-direction: column; /* Adicionado para alinhar nome e localização verticalmente */
            line-height: 1.2; /* Ajuste para melhor espaçamento vertical */
        }
        #name-container .name {
            font-size: 1em;
        }
        #name-container .location {
            font-size: 0.5em; /* Localização menor */
            opacity: 0.7;
        }
        .fade-in { opacity: 1; }
        .fade-out { opacity: 0; }
        .controls { 
            display: flex; 
            gap: 20px; 
            justify-content: center; 
            align-items: center; 
            padding: 20px; 
            background-color: rgba(0, 0, 0, 0.3); 
            border-top: 2px solid #D4B851; 
            width: 100%; 
        }
	        /* Classe para ocultar os botões */
	        .hidden-controls {
	            visibility: hidden;
	            opacity: 0;
	            transition: visibility 0s 0.3s, opacity 0.3s ease;
	        }
	        /* Mostrar os botões quando o mouse estiver sobre a área de controles */
	        .controls:hover .hidden-controls {
	            visibility: visible;
	            opacity: 1;
	            transition: opacity 0.3s ease;
	        }
	        /* Garantir que os botões dentro do container hidden-controls tenham o mesmo estilo */
	        #button-container button {
	            transition: opacity 0.3s ease;
	        }
        button { padding: 12px 30px; font-size: 1.2vw; font-weight: bold; color: #004d40; background-color: #D4B851; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease, transform 0.2s ease; font-family: Arial, sans-serif; }
        button:hover { background-color: #C1A748; /* Tom mais escuro para o hover */ transform: scale(1.05); }
        button:active { transform: scale(0.95); }
        button:disabled { background-color: #999; cursor: not-allowed; opacity: 0.6; }
        .info { color: #D4B851; font-size: 1vw; margin-left: 20px; }
        .progress-bar { width: 300px; height: 8px; background-color: rgba(212, 184, 81, 0.3); /* Baseado no #D4B851 */ border-radius: 5px; overflow: hidden; margin-left: 20px; }
        .progress-fill { height: 100%; background-color: #D4B851; width: 0%; transition: width 0.1s linear;},{find: }
    </style>
</head>
<body>
	    <div id="name-container">Carregando nomes...</div>
	    <div class="controls">
	        <div id="button-container" class="hidden-controls" style="display: flex; gap: 20px;">
	            <button id="play-btn" disabled>▶ Play</button>
	            <button id="pause-btn" disabled>⏸ Pause</button>
	        </div>
	        <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
	        <div class="info"><span id="current-name-number">0</span> / <span id="total-names">0</span></div>
	    </div>
	    <script>
        let names = [];
        // CORREÇÃO: Usar ponto (.) como separador decimal em JavaScript (0.5 * 1000)
        const durationPerName = 0.5 * 1000; 
        const transitionTime = 1000;
	        const container = document.getElementById('name-container');
	        const playBtn = document.getElementById('play-btn');
	        const pauseBtn = document.getElementById('pause-btn');
	        const buttonContainer = document.getElementById('button-container'); // Novo elemento container dos botões
        const progressFill = document.getElementById('progress-fill');
        const currentNameNumber = document.getElementById('current-name-number');
        const totalNamesEl = document.getElementById('total-names');

        let currentIndex = 0;
        let isPlaying = false;
        let timeoutId = null;
        let transitionTimeoutId = null;

        /**
         * Processa a string de nome e localização para retornar um objeto estruturado.
         * Ex: "NOME COMPLETO - Setor:1Jazigo:73Quadra:EUCALIPTOS"
         * Retorna: { name: "NOME COMPLETO", location: "Setor: 1 | Jazigo: 73 | Quadra: EUCALIPTOS" }
         */
        function parseNameAndLocation(fullString) {
            const parts = fullString.split(' - ');
            const name = parts[0] || 'Nome Desconhecido';
            let location = parts[1] || '';

            // Adiciona espaços e barras para formatar a localização
            location = location
                .replace(/Setor:/g, 'Setor: ')
                .replace(/Jazigo:/g, ' | Jazigo: ')
                .replace(/Quadra:/g, ' | Quadra: ');

            // Remove o primeiro " | " se existir
            if (location.startsWith(' | ')) {
                location = location.substring(3);
            }

            return { name, location };
        }

        // Função para exibir o nome e a localização no container
        function displayCurrentName() {
            const data = names[currentIndex];
            const parsed = parseNameAndLocation(data);
            
            // Usar innerHTML para criar duas linhas (nome e localização)
            container.innerHTML = `
                <div class="name">${parsed.name}</div>
                <div class="location">${parsed.location}</div>
            `;
        }

        // Carrega os nomes do arquivo JSON
	        
        fetch('names.json') 
            .then(response => {
                if (!response.ok) {
                    throw new Error('Erro ao carregar names.json: ' + response.statusText);
                }
                // CORREÇÃO: O JSON é um array de strings, não um objeto com a chave 'names'.
                return response.json(); 
            })
            .then(data => {
                // O JSON já é o array de nomes
                names = data; 
                totalNamesEl.textContent = names.length;
                playBtn.disabled = false;
                
                // Exibe o primeiro nome imediatamente
                if (names.length > 0) {
                    currentIndex = 0; // Garante que o índice começa em 0
                    displayCurrentName();
                    container.style.opacity = 1; 
                } else {
                    container.textContent = "Lista de nomes vazia.";
                }
                
                playBtn.disabled = false;
                pauseBtn.disabled = true;
                
            })
            .catch(error => {
                console.error("Erro ao carregar a lista de nomes:", error);
                container.textContent = "Erro ao carregar nomes. Verifique se o arquivo names.json está na mesma pasta.";
            });

	        function updateCounter() { currentNameNumber.textContent = currentIndex + 1; } // +1 para exibição amigável
	        function updateProgressBar() { progressFill.style.width = ((currentIndex + 1) / names.length) * 100 + '%'; }
	
	        // Função para mostrar os botões (remover a classe de ocultação)
	        // Função para mostrar os botões (remover a classe de ocultação)
	        function showButtons() {
	            buttonContainer.classList.remove('hidden-controls');
	        }
	
	        // Função para ocultar os botões (adicionar a classe de ocultação)
	        function hideButtons() {
	            buttonContainer.classList.add('hidden-controls');
	        }
	
	        function showNextName() {
            if (!isPlaying) return;

            // Se o índice atual for o último, paramos e exibimos a mensagem final
            if (currentIndex >= names.length - 1) { 
                // 1. Fade-out do último nome
                container.classList.remove('fade-in');
                container.classList.add('fade-out');

                // 2. Mudar para a mensagem final após o tempo de transição
                transitionTimeoutId = setTimeout(() => {
                    container.innerHTML = "Em Memória de Todos os Falecidos";
                    container.classList.remove('fade-out');
                    container.classList.add('fade-in');
                    isPlaying = false;
                    playBtn.disabled = false;
                    pauseBtn.disabled = true;
                    currentNameNumber.textContent = names.length; // Atualiza contador para o total
                    progressFill.style.width = '100%';
                }, transitionTime);
                
                return;
            }
            
            // Avança para o próximo índice
            currentIndex++;
            
            // 1. Fade-out do nome anterior
            container.classList.remove('fade-in');
            container.classList.add('fade-out');

            // 2. Mudar o nome e fazer fade-in após o tempo de transição
            transitionTimeoutId = setTimeout(() => {
                displayCurrentName();
                container.classList.remove('fade-out');
                container.classList.add('fade-in');
                updateCounter();
                updateProgressBar();
                // Agenda o próximo showNextName
                timeoutId = setTimeout(showNextName, durationPerName); 
            }, transitionTime);
        }

	        function play() {
	            if (isPlaying) return;
	            
	            isPlaying = true;
	            playBtn.disabled = true;
	            pauseBtn.disabled = false;
	            hideButtons(); // Oculta os botões após o play
	            
	            // Se já tiver terminado, recomeça do início
            if (currentIndex >= names.length - 1) { 
                currentIndex = -1; // -1 para que o showNextName comece no 0
                container.classList.remove('fade-in');
                container.classList.remove('fade-out');
            }
            
            // Inicia o ciclo
            showNextName();
        }

	        function pause() {
	            if (!isPlaying) return;
	            isPlaying = false;
	            playBtn.disabled = false;
	            pauseBtn.disabled = true;
	            showButtons(); // Mostra os botões ao pausar para que o usuário possa dar play novamente
	            clearTimeout(timeoutId);
	            clearTimeout(transitionTimeoutId);
	        }

	        playBtn.addEventListener('click', play);
	        pauseBtn.addEventListener('click', pause);
	        
	        // A lógica de hover no CSS já garante que os botões apareçam
	        // quando o mouse estiver sobre o div.controls.
	        
	        // Inicializa o contador e a barra de progresso
	        updateCounter();
	        updateProgressBar();
	        
	        // Mostra os botões inicialmente para permitir o primeiro play
	        showButtons();
    </script>
</body>
</html>
